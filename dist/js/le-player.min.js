!function(a){"use strict";var b=function(b,c){var d=a.extend(!0,{autoplay:!1,height:"auto",loop:!1,muted:!1,preload:"metadata",poster:null,width:"auto",rate:{step:.25,min:.5,max:4},playback:{step:{"short":5,medium:30,"long":60}},volume:{step:.1},controls:[{element:null,controls:["play","volume","divider","timeline","divider","fullscreen"]},{element:null,controls:["rate","divider","backward","divider","subtitles","divider","download"]}]},c),e=[],f=[],g=b[0],h={};if("video"!=b.prop("tagName").toLowerCase())return console.warn("Incorrect element selected."),this;if(b.children("source").each(function(){var b=a(this).attr("src");b&&e.push(b)}),0==e.length){var i=b.attr("src");i&&e.push(b.attr("src"))}if(0==e.length)return console.warn("No sources found."),this;b.attr("src",e[0]),b.children('track[kind="subtitles"]').each(function(){var b=a(this).attr("srclang"),c=a(this).attr("label"),d=a(this).attr("src");c.length>0&&d.length>0&&f.push({title:c,src:d,language:b})}),b.removeAttr("controls");var j=b.attr("height");j&&(d.height=j+"px",b.removeAttr("height")),b.css("height",d.height);var k=b.attr("width");k&&(d.width=k+"px",b.removeAttr("width")),b.css("width",d.width);var l=b.attr("poster");l?d.poster=l:d.poster&&b.attr("poster",d.poster);var m=["autoplay","loop","muted"];for(var n in m){var o=b.attr(m[n]);o?d[m[n]]=!0:d[m[n]]?b.attr(m[n],""):b.removeAttr(m[n]),b.prop(m[n],d[m[n]])}var l=b.attr("preload");l&&(l=l.toLowerCase(),"none"==l||"metadata"==l?d.preload=l:d.preload="auto"),b.attr("preload",d.preload);var p=function(a,b){var c=document.cookie.split(";");for(var d in c){var e=c[d].trim().split("=");if(e[0]=="leplayer_"+a)return e[1]}return b},q=function(a,b){var c=new Date;c.setDate(c.year+1),document.cookie="leplayer_"+a+"="+b+";expires="+c.toString()},r=function(b){switch(b){case"backward":return h.backward=a("<div />").addClass("control backward").append(a("<i />").addClass("fa fa-undo")),h.backward;case"divider":return a("<div />").addClass("divider");case"download":return h.download=a("<a />").attr("href",e[0]).attr("target","_blank").attr("download",e[0]).addClass("control download").append(a("<i />").addClass("fa fa-download")),h.download;case"forward":return h.forward=a("<div />").addClass("control forkward").append(a("<i />").addClass("fa fa-redo")),h.forward;case"fullscreen":return h.fullscreen=a("<div />").addClass("control fullscreen").append(a("<i />").addClass("fa fa-arrows-alt")),h.fullscreen;case"play":return h.play=a("<div />").addClass("control play").append(a("<i />").addClass("fa fa-play")),h.play;case"rate":return h.rate={down:a("<div />").addClass("control rate-down").append(a("<i />").addClass("fa fa-backward")),up:a("<div />").addClass("control rate-down").append(a("<i />").addClass("fa fa-forward")),current:a("<div />").addClass("control-text rate-current"),display:function(){this.current.html("Ã—"+g.playbackRate.toFixed(2))},increase:function(){g.playbackRate<d.rate.max?(this.down.removeClass("disabled"),g.playbackRate+=d.rate.step,this.display(),q("rate",g.playbackRate)):this.up.addClass("disabled")},decrease:function(){g.playbackRate>d.rate.min?(this.up.removeClass("disabled"),g.playbackRate-=d.rate.step,this.display(),q("rate",g.playbackRate)):this.down.addClass("disabled")}},a("<div />").addClass("control-container").append(h.rate.down).append(h.rate.current).append(h.rate.up);case"subtitles":if(f.length>0){h.subtitles=[];var c=a("<div/>").addClass("control-inner");for(var i in f)h.subtitles.push(a("<div />").addClass("inner-item").data("src",f[i].src).data("language",f[i].language).html(f[i].title));for(var i in h.subtitles)c.append(h.subtitles[i]);return a("<div />").addClass("control control-container").append(a("<div />").addClass("subtitles-icon").append(a("<i />").addClass("fa fa-commenting-o"))).append(c)}return null;case"timeline":return h.time={current:a("<div />").addClass("control-text time-current"),total:a("<div />").addClass("control-text time-total"),line:a("<div />").addClass("timeline")},a("<div />").addClass("timeline-container").append(a("<div />").addClass("timeline-subcontainer").append(h.time.current).append(h.time.line).append(h.time.total));case"volume":return h.volume={active:a("<div/>").addClass("volume-active"),marker:a("<div/>").addClass("volume-marker"),icon:a("<div/>").addClass("volume-icon").append(a("<i />").addClass("fa fa-volume-down")),set:function(a){var b=this.icon.children(".fa").eq(0);b.removeClass(),.05>a?(g.muted=!0,b.addClass("fa fa-volume-off")):(g.muted=!1,g.volume=a,.5>a?b.addClass("fa fa-volume-down"):b.addClass("fa fa-volume-up"),q("volume",a));var c=Math.round(100*a).toString()+"%";this.active.css("height",c),this.marker.css("bottom",c)},toggleMuted:function(){1==g.muted?this.set(p("volume",.4)):this.set(0)}},h.volume.line=a("<div/>").addClass("volume-line").append(h.volume.active).append(h.volume.marker),h.volume.container=a("<div />").addClass("control control-container").append(h.volume.icon).append(a("<div />").addClass("control-inner volume-slider").append(h.volume.line)),h.volume.container;default:return null}},s=function(b){switch(b){case"backward":h.backward.click(function(){g.currentTime-d.playback.step.medium>0&&w(g.currentTime-d.playback.step.medium)});break;case"fullscreen":h.fullscreen.click(function(){v()});break;case"play":h.play.click(function(){u()});break;case"rate":g.playbackRate=p("rate",1),h.rate.display(),h.rate.up.click(function(){h.rate.increase()}),h.rate.down.click(function(){h.rate.decrease()});break;case"subtitles":for(var c in h.subtitles)h.subtitles[c].click(function(){x(a(this).data("language"))});break;case"volume":var e=!1,f={bottom:0,height:0,top:0};h.volume.marker.on("mousedown",function(a){e=!0,f.height=h.volume.line.height(),f.top=h.volume.line.offset().top,f.bottom=f.top+f.height}),a(document).on("mousemove",function(a){e&&a.pageY>=f.top&&a.pageY<=f.bottom&&h.volume.set((f.bottom-a.pageY)/f.height)}).on("mouseup",function(a){e=!1}),h.volume.line.click(function(a){f.height=h.volume.line.height(),f.top=h.volume.line.offset().top,f.bottom=f.top+f.height,a.pageY>=f.top&&a.pageY<=f.bottom&&h.volume.set((f.bottom-a.pageY)/f.height)}),h.volume.icon.click(function(){h.volume.toggleMuted()}),h.volume.set(p("volume",.4))}},t=a("<div />").addClass("play-overlay"),u=function(){!g.played||g.paused?(t.hide(),g.play(),"undefined"!=typeof h.play&&h.play.children(".fa").removeClass("fa-play").addClass("fa-pause")):(t.show(),g.pause(),"undefined"!=typeof h.play&&h.play.children(".fa").removeClass("fa-pause").addClass("fa-play"))},v=function(){g.requestFullScreen?g.requestFullScreen():g.webkitRequestFullScreen?g.webkitRequestFullScreen():g.mozRequestFullScreen?g.mozRequestFullScreen():console.warn("Cannot toggle fullscreen.")},w=function(a){g.currentTime=a},x=function(a){},y=a("<div />").addClass("leplayer-video"),z=a("<div />").addClass("leplayer-container").append(y);b.wrap(z),y=b.parent(),y.append(t),z=y.parent(),setTimeout(function(){t.css("line-height",t.height()+"px").html('<i class="fa fa-play"></i>')},100),t.click(function(){u()}),b.keypress(function(a){32==a.charCode&&u()}).click(function(){u()});for(var n in d.controls){var A=d.controls[n].element;if(null==A&&(A=a("<div />").addClass("leplayer-controls")),0==A.length)console.warn("Error creating controls.");else{for(var B in d.controls[n].controls){var C=r(d.controls[n].controls[B]);null!=C&&C.length>0?(A.append(C),s(d.controls[n].controls[B])):console.warn("Cannot create "+d.controls[n].controls[B]+" control.")}z.append(A)}}};a.fn.lePlayer=function(c){return this.each(function(){b(a(this),c)})}}(jQuery);